#!/bin/bash

# check_disk_usage.sh
# 서버의 디스크 용량(%)을 확인하고, 90% 이상이면 경고를 출력하는 스크립트입니다.

echo "--- 현재 디스크 사용량을 확인합니다 ---"
echo ""

# 'df -h': 디스크 용량을 사람이 읽기 쉬운 형태(GB, MB)로 보여줌
# 'grep /': 많은 결과 중 '/' (루트)가 포함된 줄만 필터링 (루트 디스크가 가장 중요)
# 'awk '{print $5}'': 필터링된 줄에서 5번째 조각(사용률 %)만 잘라냄
USAGE=$(df -h | grep '/' | awk '{print $5}' | sed 's/%//g')

echo "현재 루트 디스크 사용률: ${USAGE}%"
echo ""

# 'if'문으로 사용률(USAGE)이 90 이상인지 '숫자 비교(-ge)'
if [ $USAGE -ge 90 ]; then
  echo "!! 경고: 디스크 용량이 90%를 초과했습니다. 정리가 필요합니다."
else
  echo "  [정상] 디스크 용량이 90% 미만입니다."
fi

echo "--- 확인 완료 ---"